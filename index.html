<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Demo Mines + Plinko</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    background:#111;
    font-family:Arial;
    color:white;
    margin:0;
    text-align:center;
}
.wrapper{
    width:100%;
    max-width:400px;
    margin:auto;
}
button{
    margin:5px;
    padding:10px;
    cursor:pointer;
    background:#333;
    color:white;
    border:1px solid #666;
}
input{
    width:80px;
    padding:6px;
    margin:6px;
    background:#222;
    color:white;
    border:1px solid #555;
}
#minesField{
    display:grid;
    grid-template-columns:repeat(5,1fr);
    gap:5px;
    margin-top:15px;
}
.mine{
    width:60px;
    height:60px;
    background:#222;
    display:flex;
    justify-content:center;
    align-items:center;
    cursor:pointer;
    font-size:20px;
}
.mine.open{background:#37b25b;}
.mine.dead{background:#b23636;}
#plinko{
    margin-top:25px;
}
.row{
    display:flex;
    justify-content:center;
}
.slot{
    width:28px;
    height:28px;
    background:#444;
    border-radius:50%;
    margin:4px;
}
#ball{
    width:26px;
    height:26px;
    background:white;
    border-radius:50%;
    position:absolute;
    left:50%;
    top:90px;
    transform:translateX(-50%);
    display:none;
}
#bottomRow{
    display:flex;
    justify-content:center;
    margin-top:220px;
}
.bottomSlot{
    width:60px;
    height:60px;
    background:#222;
    margin:3px;
    display:flex;
    justify-content:center;
    align-items:center;
    border:1px solid #555;
}
</style>
</head>
<body>

<div class="wrapper">
<h2>DEMO GAME</h2>

Баланс: <span id="bal">100</span><br>
Ставка: <input id="bet" value="1" type="number" step="0.1" min="0.1" max="10">

<br>
Мин: <span id="mcount">5</span><br>
<button onclick="minusM()">-</button>
<button onclick="plusM()">+</button>
<button onclick="playMines()">Играть Мины</button>
<div id="minesField"></div>

<br><br>

<button onclick="playPlinko()">Играть Blinko</button>
<div id="plinko">
    <div id="ball"></div>
</div>
<div id="bottomRow"></div>

</div>

<script>
let balance = 100;
let mines = 5;
let openCount = 0;
let dead = false;
let field = [];
let pay = 0;

// MINES --------------------------
function minusM(){if(mines>5){mines--;document.getElementById("mcount").innerText=mines;}}
function plusM(){if(mines<10){mines++;document.getElementById("mcount").innerText=mines;}}

function playMines(){
    resetMines();
    const bet = readBet();
    if(!bet) return;
    balance -= bet;
    updateBal();
    dead = false;
    let arr = [];
    for(let i=0;i<25;i++) arr.push(i);
    arr.sort(()=>Math.random()-.5);
    field = arr.slice(0,mines);
}

function resetMines(){
    document.getElementById("minesField").innerHTML="";
    for(let i=0;i<25;i++){
        let d = document.createElement("div");
        d.className = "mine";
        d.onclick = ()=>openMine(i,d);
        document.getElementById("minesField").appendChild(d);
    }
    openCount=0;
}

function openMine(i,cell){
    if(dead) return;
    if(field.includes(i)){
        cell.className="mine dead";
        dead=true;
        return;
    }
    cell.className="mine open";
    openCount++;
    if(openCount>=25-mines) winMines();
}

function winMines(){
    let bet = readBet();
    let coef = mines<=6?1.5:mines<=8?2.2:4;
    balance += bet*coef;
    updateBal();
}

// PLINKO ------------------------
function playPlinko(){
    const bet = readBet();
    if(!bet)return;
    balance -= bet;
    updateBal();
    runPlinko(bet);
}

function runPlinko(bet){
    let ball = document.getElementById("ball");
    ball.style.left="50%";
    ball.style.top="90px";
    ball.style.display="block";
    let x = 50;
    let y = 90;
    let steps = 8;
    let drift = 0;

    function frame(){
        y+=12;
        drift += (Math.random()-.5)*6;
        x+=drift;
        ball.style.left = x+"%";
        ball.style.top = y+"px";

        if(steps<=0){
            finishPlinko(bet,x);
            return;
        }

        if(y>140+steps*15){
            steps--;
        }
        requestAnimationFrame(frame);
    }
    frame();
}

function finishPlinko(bet,x){
    let index = Math.floor((x-10)/10);
    let zones = [
        0,
        bet*2,
        bet*1.5,
        bet*0.7,
        bet*0.5,
        bet*0.7,
        bet*1.5,
        bet*2,
        0
    ];
    let win = zones[index]||0;
    balance+=win;
    updateBal();
}

function updateBal(){
    document.getElementById("bal").innerText = balance.toFixed(1);
}

function readBet(){
    let bet = parseFloat(document.getElementById("bet").value);
    if(bet<0.1 || bet>10) return false;
    return bet;
}
</script>

</body>
</html>
