<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Demo Casino</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

body{
    background:#fafafa;
    margin:0;
    font-family:Arial;
    text-align:center;
}

.container{
    max-width:420px;
    margin:auto;
    margin-top:20px;
    padding:15px;
    background:white;
    border-radius:10px;
    box-shadow:0px 0px 10px #00000020;
}

h2{
    margin:5px 0 15px 0;
}

button,input{
    padding:8px;
    margin:5px;
    border-radius:6px;
    border:1px solid #ccc;
}

button{
    cursor:pointer;
    background:#eee;
}

#bal{
    font-weight:bold;
    color:#2c7d00;
    font-size:22px;
}

#minesField{
    display:grid;
    grid-template-columns:repeat(5,1fr);
    gap:4px;
    margin-top:10px;
}

.tile{
    height:55px;
    background:#e8e8e8;
    border-radius:6px;
    cursor:pointer;
    display:flex;
    justify-content:center;
    align-items:center;
    font-size:20px;
}

.tile.safe{
    background:#78ff8c;
}

.tile.boom{
    background:#ff7878;
    color:white;
}

#cashoutBtn{
    display:none;
    background:#ffd800;
    font-weight:bold;
}

/* PLINKO */

#plinkoArea{
    position:relative;
    height:350px;
    margin-top:20px;
}

.pin{
    width:10px;
    height:10px;
    background:#444;
    border-radius:50%;
    position:absolute;
}

#ball{
    width:16px;
    height:16px;
    background:red;
    border-radius:50%;
    position:absolute;
    top:10px;
    left:50%;
    margin-left:-8px;
    display:none;
}

.slot{
    width:45px;
    height:40px;
    background:#ddd;
    position:absolute;
    bottom:0;
    border-radius:6px;
    display:flex;
    justify-content:center;
    align-items:center;
    font-size:14px;
}
</style>

</head>
<body>

<div class="container">

<h2>DEMO BALANCE: <span id="bal">100</span> TON</h2>

Ставка:<br>
<input id="bet" type="number" min="0.1" max="10" value="1" step="0.1">

<br><br>

<!-- MINES -->

<h3>Mines</h3>

Мин количества: <span id="mineCount">5</span><br>
<button onclick="minusMine()">-</button>
<button onclick="plusMine()">+</button>
<button onclick="startMines()">Start Mines</button>
<button id="cashoutBtn" onclick="cashout()">Cashout</button>

<div id="minesField"></div>

<hr>

<!-- PLINKO -->
<h3>Plinko</h3>

<button onclick="startPlinko()">Play Plinko</button>

<div id="plinkoArea"></div>

<div id="result" style="font-size:18px;margin-top:10px;"></div>

</div>

<script>

let balance = 100;

/* BALANCE */
function updateBalance(){
    document.getElementById("bal").innerText = balance.toFixed(1);
}

/* GET BET */
function getBet(){
    let bet = parseFloat(document.getElementById("bet").value);
    if(bet < 0.1 || bet > 10){return false;}
    if(bet > balance){return false;}
    return bet;
}

/* ----- MINES GAME ----- */

let mineAmt = 5;
let mineBombs = [];
let mineTiles = [];
let opened = 0;
let active = false;
let gameBet = 0;

function minusMine(){ if(mineAmt > 5){mineAmt--; document.getElementById("mineCount").innerText = mineAmt;} }
function plusMine(){ if(mineAmt < 10){mineAmt++; document.getElementById("mineCount").innerText = mineAmt;} }

function startMines(){

    let bet = getBet();
    if(!bet) return;

    balance -= bet;
    updateBalance();

    gameBet = bet;

    active = true;
    opened = 0;

    document.getElementById("cashoutBtn").style.display="inline-block";

    let field = document.getElementById("minesField");
    field.innerHTML="";

    let arr=[];
    for(let i=0;i<25;i++){arr.push(i);}
    arr.sort(()=>Math.random()-.5);
    mineBombs = arr.slice(0,mineAmt);

    mineTiles=[];

    for(let i=0;i<25;i++){
        let t=document.createElement("div");
        t.className="tile";
        t.onclick = ()=> openTile(i,t);
        field.appendChild(t);
        mineTiles.push(t);
    }
}

function openTile(i, el){

    if(!active) return;

    if(mineBombs.includes(i)){
        el.classList.add("boom");
        active=false;
        document.getElementById("cashoutBtn").style.display="none";
        return;
    }

    el.classList.add("safe");
    opened++;

}

function cashout(){
    if(!active) return;

    let coef =
        mineAmt==5? opened*0.2 + 1 :
        mineAmt==6? opened*0.26 + 1 :
        mineAmt==7? opened*0.33 + 1 :
        mineAmt==8? opened*0.41 + 1 :
        mineAmt==9? opened*0.52 + 1 :
        opened*0.65 + 1;

    let win = gameBet * coef;

    balance += win;
    updateBalance();

    document.getElementById("cashoutBtn").style.display="none";
    active=false;
}

/* ---------- PLINKO ---------- */

function startPlinko(){

    let bet = getBet();
    if(!bet) return;

    balance -= bet;
    updateBalance();

    runPlinko(bet);
}

function runPlinko(bet){

    document.getElementById("plinkoArea").innerHTML="";

    let ball=document.createElement("div");
    ball.id="ball";
    ball.style.display="block";

    let area=document.getElementById("plinkoArea");
    area.appendChild(ball);

    let x = 160;
    let y = 10;

    let dx = 0;

    let rows = 8;
    let radius = 25;

    let slots = [
        0, bet*2, bet*1.5, bet*0.7, bet*0.5,
        bet*0.7, bet*1.5, bet*2, 0
    ];

    function animate(){

        y += 5;
        dx += (Math.random()-.5)*2;
        x += dx;

        ball.style.top = y+"px";
        ball.style.left = x+"px";

        if(y >= 300){
            let index = Math.floor((x-10)/40);
            let w = slots[index]||0;

            balance += w;
            updateBalance();

            return;
        }

        requestAnimationFrame(animate);
    }

    animate();
}

</script>

</body>
</html>
