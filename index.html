<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Johan Game â€“ Mines</title>
<style>
    body {
        background: linear-gradient(135deg, #ffd4f5, #ffecfd);
        font-family: Arial;
        text-align: center;
        color: #444;
    }

    #balanceBox {
        margin-top: 20px;
        background: white;
        padding: 10px;
        width: 260px;
        border-radius: 12px;
        margin-left: auto;
        margin-right: auto;
        font-size: 20px;
        border: 2px solid #ff9de6;
    }

    #controls {
        margin-top: 15px;
    }

    input, select {
        padding: 6px;
        border-radius: 6px;
        border: 1px solid #ff9de6;
        font-size:16px;
        outline:none;
    }

    button {
        padding: 8px 14px;
        background: #ff74e6;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size:16px;
    }

    #grid {
        width: 320px;
        margin: 20px auto;
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 4px;
    }

    .tile {
        width: 60px;
        height: 60px;
        background: white;
        border-radius: 10px;
        font-size: 34px;
        display:flex;
        align-items:center;
        justify-content:center;
        cursor:pointer;
        transition:0.2s;
        border: 2px solid #ffb8f1;
    }
</style>
</head>

<body>

<div id="balanceBox">
    ðŸ’Ž Balance: <span id="balance">100</span> TON
</div>

<div id="controls">

    Bet TON:
    <input id="bet" type="number" step="0.1" min="0.1" value="0.1" />

    <br><br>

    Mines:
    <select id="mineCount">
        <option>1</option><option>2</option><option>3</option>
        <option>4</option><option>5</option><option>6</option>
        <option>7</option><option>8</option><option>9</option>
        <option>10</option>
    </select>

    <br><br>

    <button onclick="startGame()">Start Game</button>
    <button onclick="cashout()">Cashout</button>

</div>

<div id="grid"></div>

<script>

let balance = 100;
let bet = 0;
let gameActive = false;
let mines = [];
let clicks = 0;

function updateBalance() {
    document.getElementById("balance").innerText = balance.toFixed(2);
}

function startGame() {

    if (gameActive) return;

    bet = Number(document.getElementById("bet").value);

    if (bet < 0.1) { alert("Min bet is 0.1 TON"); return; }
    if (bet > balance) { alert("Not enough balance"); return; }

    let m = Number(document.getElementById("mineCount").value);

    balance -= bet;
    updateBalance();

    gameActive = true;
    clicks = 0;

    mines = [];
    while (mines.length < m) {
        let r = Math.floor(Math.random()*25);
        if (!mines.includes(r)) mines.push(r);
    }

    drawGrid();
}

function drawGrid() {
    let box = document.getElementById("grid");
    box.innerHTML = "";

    for (let i=0;i<25;i++){
        let tile = document.createElement("div");
        tile.className = "tile";
        tile.dataset.id = i;
        tile.onclick = () => clickTile(i,tile);
        box.appendChild(tile);
    }
}

function clickTile(id,tile){

    if (!gameActive) return;

    if (mines.includes(id)) {
        tile.style.background="#ff4a7e";
        tile.innerHTML="ðŸ’£";
        endGame(false);
        return;
    }

    clicks++;

    tile.style.background="#8cffc9";
    tile.innerHTML="ðŸ’Ž";
    tile.onclick="";

}

function cashout(){

    if (!gameActive) return;

    let multiplier = 1 + (clicks * 0.25);
    let win = bet * multiplier;

    balance += win;
    updateBalance();

    revealAll();
    gameActive = false;
}

function endGame(loss){
    gameActive = false;
    if (loss) {}
    revealAll();
}

function revealAll(){

    [...document.getElementsByClassName("tile")].forEach(t=>{
        let id = Number(t.dataset.id);
        if (mines.includes(id)){
            t.style.background="#ff4a7e";
            t.innerHTML="ðŸ’£";
        }
    });

}

</script>
</body>
</html>
