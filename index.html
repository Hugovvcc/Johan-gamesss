<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Johan Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root {
  --pink: #ff9ccd;
  --pink-dark: #ff6bb5;
  --pink-light: #ffe6f3;
  --bg-dark: #0f001a;
  --text: #ff9ccd;
  --win: #00ff9d;
  --lose: #ff3366;
}

body {
  margin: 0;
  padding: 0;
  background: linear-gradient(135deg, #1a0033, #330066);
  color: var(--text);
  font-family: system-ui, -apple-system, sans-serif;
  min-height: 100vh;
}

h1 {
  text-align: center;
  font-size: 3rem;
  margin: 20px 0 10px;
  background: linear-gradient(90deg, var(--pink), var(--pink-dark), #d946ef);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

.container {
  max-width: 700px;
  margin: 0 auto;
  padding: 20px;
}

button {
  padding: 12px 28px;
  margin: 10px 4px;
  font-size: 1.1rem;
  border: none;
  border-radius: 50px;
  background: linear-gradient(45deg, var(--pink), var(--pink-dark));
  color: white;
  cursor: pointer;
  transition: all 0.25s;
}

button:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(255,105,180,0.5); }

input, select {
  padding: 10px 14px;
  font-size: 1.1rem;
  border-radius: 12px;
  border: 2px solid var(--pink);
  background: rgba(255,255,255,0.08);
  color: var(--text);
  margin: 8px 0;
}

.section {
  background: rgba(20,0,40,0.65);
  border-radius: 20px;
  padding: 25px;
  margin: 20px 0;
  backdrop-filter: blur(8px);
  border: 1px solid rgba(255,105,180,0.25);
}

#minesGrid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
  max-width: 380px;
  margin: 25px auto;
}

.minecell {
  aspect-ratio: 1;
  background: rgba(255,255,255,0.12);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2.2rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid rgba(255,105,180,0.3);
}

.minecell:hover { background: rgba(255,105,180,0.25); transform: scale(1.06); }

#crashCanvas {
  width: 100%;
  max-width: 420px;
  height: 500px;
  margin: 20px auto;
  display: block;
  border-radius: 16px;
  border: 3px solid var(--pink-dark);
  background: #0a0014;
}

.multiplier {
  font-size: 3.8rem;
  font-weight: bold;
  text-align: center;
  margin: 15px 0;
  background: linear-gradient(90deg, #ff9ccd, #ff6bb5, #d946ef);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.message {
  font-size: 1.3rem;
  padding: 14px;
  border-radius: 12px;
  margin: 15px 0;
}

.win { background: rgba(0,255,157,0.25); border: 2px solid var(--win); }
.lose { background: rgba(255,51,102,0.25); border: 2px solid var(--lose); }
</style>
</head>
<body>

<div class="container">

  <h1>Johan Game</h1>
  <h3>TON: <span id="ton">100.0</span></h3>

  <!-- –ì–ª–∞–≤–Ω—ã–π –≤—ã–±–æ—Ä -->
  <div class="section" id="mode-select">
    <h2>–í—ã–±–µ—Ä–∏ —Ä–µ–∂–∏–º</h2>
    <button onclick="showSection('mines')">Mines</button>
    <button onclick="showSection('crash')">Crash</button>
  </div>

  <!-- Mines -->
  <div class="section" id="mines-section" style="display:none;">
    <h2>Mines</h2>
    
    <label>–°—Ç–∞–≤–∫–∞:</label>
    <input type="number" id="mines-bet" min="0.1" max="10" step="0.1" value="1">
    
    <label style="margin-left:20px;">–ú–∏–Ω—ã:</label>
    <select id="mines-count">
      <option value="5">5</option>
      <option value="6">6</option>
      <option value="7">7</option>
      <option value="8">8</option>
      <option value="9">9</option>
      <option value="10">10</option>
    </select>

    <div style="margin:20px 0;">
      <button onclick="startMines()">–°—Ç–∞—Ä—Ç</button>
      <button id="mines-cashout" onclick="cashoutMines()" disabled>–ó–∞–±—Ä–∞—Ç—å</button>
    </div>

    <p>–û—Ç–∫—Ä—ã—Ç–æ: <span id="opened">0</span> | –ú–Ω–æ–∂–∏—Ç–µ–ª—å: <span id="multi">1.00x</span></p>
    <div id="mines-message" class="message"></div>
    <div id="minesGrid"></div>
  </div>

  <!-- Crash -->
  <div class="section" id="crash-section" style="display:none;">
    <h2>Crash</h2>
    
    <label>–°—Ç–∞–≤–∫–∞:</label>
    <input type="number" id="crash-bet" min="0.1" max="10" step="0.1" value="1">
    
    <div style="margin:20px 0;">
      <button onclick="startCrash()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞–∫–µ—Ç—É</button>
      <button id="crash-cashout" onclick="crashCashout()" disabled>–ó–∞–±—Ä–∞—Ç—å</button>
    </div>

    <div class="multiplier" id="crash-multi">1.00x</div>
    <div id="crash-message" class="message"></div>
    <canvas id="crashCanvas" width="400" height="520"></canvas>
  </div>

</div>

<script>
let ton = 100;
document.getElementById("ton").textContent = ton.toFixed(1);

function showSection(mode) {
  document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
  document.getElementById(mode + '-section').style.display = 'block';
}

// MINES
function startMines() {
  const bet = parseFloat(document.getElementById('mines-bet').value);
  const minesCount = parseInt(document.getElementById('mines-count').value);

  if (isNaN(bet) || bet < 0.1 || bet > 10) return alert("–°—Ç–∞–≤–∫–∞ 0.1‚Äì10 TON");
  if (ton < bet) return alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON");

  ton -= bet;
  document.getElementById("ton").textContent = ton.toFixed(1);

  let minesPos = new Set();
  while (minesPos.size < minesCount) {
    minesPos.add(Math.floor(Math.random() * 25));
  }

  let opened = 0;
  let multiplier = 1;

  const grid = document.getElementById("minesGrid");
  grid.innerHTML = "";

  for (let i = 0; i < 25; i++) {
    const cell = document.createElement("div");
    cell.className = "minecell";
    cell.textContent = "?";
    cell.onclick = () => {
      if (cell.dataset.open || cell.dataset.boom) return;
      
      if (minesPos.has(i)) {
        cell.textContent = "üí£";
        cell.style.background = "rgba(255,50,100,0.7)";
        cell.dataset.boom = "true";
        document.getElementById("mines-cashout").disabled = true;
        showMessage("mines", `–ë–£–ú! –ü–æ—Ç–µ—Ä—è–Ω–æ ${bet.toFixed(1)} TON`, "lose");
      } else {
        opened++;
        multiplier *= 1.02;
        cell.textContent = "üíé";
        cell.style.background = "rgba(100,255,180,0.3)";
        cell.dataset.open = "true";

        document.getElementById("opened").textContent = opened;
        document.getElementById("multi").textContent = multiplier.toFixed(2) + "x";
      }
    };
    grid.appendChild(cell);
  }

  document.getElementById("mines-cashout").disabled = false;
  document.getElementById("mines-message").textContent = "";
}

function cashoutMines() {
  const multi = parseFloat(document.getElementById("multi").textContent);
  const bet = parseFloat(document.getElementById("mines-bet").value);
  const win = (bet * multi).toFixed(1);
  
  ton += parseFloat(win);
  document.getElementById("ton").textContent = ton.toFixed(1);
  
  showMessage("mines", `–í—ã–≤–æ–¥ –Ω–∞ ${multi.toFixed(2)}x ‚Üí +${win} TON!`, "win");
  document.getElementById("mines-cashout").disabled = true;
}

function showMessage(id, text, type) {
  const el = document.getElementById(id + "-message");
  el.textContent = text;
  el.className = "message " + (type === "win" ? "win" : "lose");
}

// CRASH - —É–ª—É—á—à–µ–Ω–Ω–∞—è —Ä–∞–∫–µ—Ç–∞
function startCrash() {
  const bet = parseFloat(document.getElementById("crash-bet").value);
  if (isNaN(bet) || bet < 0.1 || bet > 10) return alert("–°—Ç–∞–≤–∫–∞ 0.1‚Äì10 TON");
  if (ton < bet) return alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON");

  ton -= bet;
  document.getElementById("ton").textContent = ton.toFixed(1);

  let multiplier = 1;
  let crashed = false;
  let crashPoint = 1.05 + Math.pow(Math.random(), 2.5) * 60; // –∫—Ä–∞—Å–∏–≤–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

  document.getElementById("crash-multi").textContent = "1.00x";
  document.getElementById("crash-cashout").disabled = false;

  const canvas = document.getElementById("crashCanvas");
  const ctx = canvas.getContext("2d");
  let y = canvas.height - 100;
  let shake = 0;
  let time = 0;

  function draw() {
    if (crashed) return;

    ctx.fillStyle = "rgba(10,0,20,0.2)";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    time += 0.016;
    multiplier *= 1.008 + time*0.0002;
    document.getElementById("crash-multi").textContent = multiplier.toFixed(2) + "x";

    if (multiplier >= crashPoint) {
      crashed = true;
      document.getElementById("crash-cashout").disabled = true;
      alert(`–ö–†–ê–® –Ω–∞ ${multiplier.toFixed(2)}x! –ü–æ—Ç–µ—Ä—è–Ω–æ ${bet.toFixed(1)} TON`);
      setTimeout(() => location.reload(), 2500);
      return;
    }

    if (multiplier > 6) shake = (Math.random()-0.5)*8;

    y -= 1.8 + multiplier*0.4;

    ctx.save();
    ctx.translate(canvas.width/2 + shake, y);
    ctx.rotate(Math.sin(time*6)*0.1);

    // –ü–ª–∞–º—è
    const flame = 60 + Math.sin(time*18)*18;
    const g = ctx.createLinearGradient(0,0,0,flame);
    g.addColorStop(0,"#ffff00");
    g.addColorStop(0.3,"#ffaa00");
    g.addColorStop(1,"#ff0000");
    ctx.fillStyle = g;
    ctx.beginPath();
    ctx.moveTo(0,40);
    ctx.quadraticCurveTo(-40,flame,0,flame+50);
    ctx.quadraticCurveTo(40,flame,0,40);
    ctx.fill();

    // –ö–æ—Ä–ø—É—Å
    ctx.fillStyle = "#ff6bb5";
    ctx.beginPath();
    ctx.moveTo(0,-70);
    ctx.quadraticCurveTo(-22,0,-18,40);
    ctx.lineTo(18,40);
    ctx.quadraticCurveTo(22,0,0,-70);
    ctx.fill();

    // –û–∫–Ω–æ
    ctx.fillStyle = "#88ddff";
    ctx.beginPath();
    ctx.arc(0,-25,14,0,Math.PI*2);
    ctx.fill();

    ctx.restore();

    requestAnimationFrame(draw);
  }

  draw();
}

function crashCashout() {
  const multi = parseFloat(document.getElementById("crash-multi").textContent);
  const bet = parseFloat(document.getElementById("crash-bet").value);
  const win = (bet * multi).toFixed(1);

  ton += parseFloat(win);
  document.getElementById("ton").textContent = ton.toFixed(1);
  
  alert(`–ó–∞–±—Ä–∞–ª–∏ –Ω–∞ ${multi.toFixed(2)}x! +${win} TON!`);
  location.reload();
}
</script>
</body>
</html>
