<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Johan Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{
  --pink: #ff9ccd;
  --pink-dark: #ff6bb5;
  --pink-bg: #ffe6f3;
  --green-win: #afffa6;
  --red-lose: #ff6b6b;
}
body{
  margin:0;
  background:var(--pink-bg);
  font-family: 'Arial Rounded MT Bold', Arial, sans-serif;
  text-align:center;
  user-select:none;
  color:#333;
}
h1{
  font-size: 48px;
  color: var(--pink-dark);
  text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
  margin: 20px 0;
}
h2{
  font-size: 32px;
  color: var(--pink-dark);
}
h3{
  font-size: 24px;
  margin: 10px;
}
button{
  padding: 14px 28px;
  border-radius: 15px;
  border: none;
  background: var(--pink);
  color: #000;
  margin: 10px;
  cursor: pointer;
  font-size: 20px;
  font-weight: bold;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  transition: all 0.2s;
}
button:hover{
  background: var(--pink-dark);
  transform: translateY(-2px);
}
button:active{
  transform: translateY(1px);
}
.screen{display:none;}
.active{display:block;}
.minecell{
  width: 60px;
  height: 60px;
  background: white;
  border-radius: 12px;
  font-size: 28px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  box-shadow: 0 3px 6px rgba(0,0,0,0.15);
  transition: all 0.2s;
}
.minecell:hover{
  transform: scale(1.05);
}
#minesGrid{
  display: grid;
  grid-template-columns: repeat(5, 60px);
  gap: 8px;
  justify-content: center;
  margin: 20px auto;
}
canvas{
  background: #fff;
  border-radius: 15px;
  box-shadow: 0 6px 12px rgba(0,0,0,0.2);
  margin: 15px auto;
  display: block;
}
#score{
  font-size: 28px;
  font-weight: bold;
  color: var(--pink-dark);
}
</style>
</head>
<body>
<h1>Johan Game</h1>
<h3>Score: <span id="score">100</span></h3>

<!-- MENU -->
<div id="menu" class="active">
  <button onclick="openScreen('mines')">Mines</button><br>
  <button onclick="openScreen('plinko')">Plinko</button><br>
  <button onclick="openScreen('escape')">Ball Escape</button>
</div>

<!-- MINES -->
<div id="mines" class="screen">
  <h2>Mines</h2>
  <p>Tiles opened: <span id="opened">0</span></p>
  <p>Multiplier: <span id="multi">1.00x</span></p>
  <button onclick="startMines()">New Game</button>
  <button onclick="cashout()" style="background:#ff6bb5;">Cash Out üí∞</button>
  <div id="minesGrid"></div>
  <button onclick="back()">‚Üê Back</button>
</div>

<!-- PLINKO -->
<div id="plinko" class="screen">
  <h2>Plinko</h2>
  <button onclick="startPlinko()">Drop Ball üéæ</button>
  <canvas id="plinkoCanvas" width="320" height="520"></canvas>
  <button onclick="back()">‚Üê Back</button>
</div>

<!-- BALL ESCAPE -->
<div id="escape" class="screen">
  <h2>Ball Escape</h2>
  <button onclick="startEscape()">Play ‚ö°</button>
  <canvas id="escapeCanvas" width="320" height="440"></canvas>
  <button onclick="back()">‚Üê Back</button>
</div>

<script>
function openScreen(id){
  document.getElementById("menu").classList.remove("active");
  document.getElementById(id).classList.add("active");
}
function back(){
  document.querySelectorAll(".screen").forEach(x => x.classList.remove("active"));
  document.getElementById("menu").classList.add("active");
}

let score = 100;
document.getElementById("score").textContent = score;

/**********************
   MINES GAME
**********************/
let mines = [];
let revealed = 0;
let multiplier = 1;

function startMines(){
  mines = [];
  revealed = 0;
  multiplier = 1;
  document.getElementById("opened").textContent = 0;
  document.getElementById("multi").textContent = "1.00x";

  // 8 –º–∏–Ω –∏–∑ 25 –∫–ª–µ—Ç–æ–∫
  while(mines.length < 8){
    let r = Math.floor(Math.random() * 25);
    if(!mines.includes(r)) mines.push(r);
  }

  let grid = document.getElementById("minesGrid");
  grid.innerHTML = "";
  for(let i = 0; i < 25; i++){
    let cell = document.createElement("div");
    cell.className = "minecell";
    cell.textContent = "?";
    cell.onclick = () => reveal(i, cell);
    grid.appendChild(cell);
  }
}

function reveal(i, cell){
  if(cell.dataset.open) return;

  if(mines.includes(i)){
    // –ë—É–º!
    cell.style.background = "var(--red-lose)";
    cell.textContent = "üí£";
    alert("üí• BOOM! You hit a mine!\nLost 5 points üòø");
    score -= 5;
    if(score < 0) score = 0;
    document.getElementById("score").textContent = score;
    startMines();
    return;
  }

  // –ë–µ–∑–æ–ø–∞—Å–Ω–æ
  revealed++;
  multiplier = 1 + (revealed * 0.20); // –ª—É—á—à–µ —Ä–∞—Å—Ç—ë—Ç
  cell.dataset.open = 1;
  cell.style.background = "var(--green-win)";
  cell.textContent = "üíé";
  cell.style.transform = "scale(1.1)";

  document.getElementById("opened").textContent = revealed;
  document.getElementById("multi").textContent = multiplier.toFixed(2) + "x";
}

function cashout(){
  if(revealed === 0) return alert("Open at least one tile first!");

  let win = Math.round(10 * multiplier);
  alert(`üéâ Cashed out at ${multiplier.toFixed(2)}x!\nYou won ${win} points! üèÜ`);
  score += win;
  document.getElementById("score").textContent = score;
  startMines();
}

/**********************
   PLINKO GAME
**********************/
function startPlinko(){
  let canvas = document.getElementById("plinkoCanvas");
  let ctx = canvas.getContext("2d");
  let pegs = [];
  let rows = 9;

  // –°–æ–∑–¥–∞—ë–º –ø–∏—Ä–∞–º–∏–¥—É –ø–µ–≥–æ–≤
  for(let r = 0; r < rows; r++){
    let pegsInRow = r + 4;
    let offset = (canvas.width - (pegsInRow * 30)) / 2;
    for(let p = 0; p < pegsInRow; p++){
      pegs.push({
        x: offset + p * 30 + 15,
        y: 80 + r * 45
      });
    }
  }

  let ball = {x: canvas.width/2, y: 30, vx: 0, vy: 0};
  let dropped = false;

  function animate(){
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // –ü–µ–≥–∏
    ctx.fillStyle = "#333";
    pegs.forEach(p => {
      ctx.beginPath();
      ctx.arc(p.x, p.y, 6, 0, Math.PI*2);
      ctx.fill();
    });

    // –®–∞—Ä–∏–∫
    ctx.fillStyle = "#ff6bb5";
    ctx.beginPath();
    ctx.arc(ball.x, ball.y, 12, 0, Math.PI*2);
    ctx.fill();

    if(!dropped){
      dropped = true;
      ball.vy = 2;
    }

    ball.vy += 0.15; // –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è
    ball.y += ball.vy;
    ball.x += ball.vx;

    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –ø–µ–≥–∞–º–∏
    pegs.forEach(p => {
      let dx = ball.x - p.x;
      let dy = ball.y - p.y;
      if(Math.sqrt(dx*dx + dy*dy) < 18){
        ball.vx += (Math.random() - 0.5) * 6;
        ball.vy = -ball.vy * 0.7 + 2;
      }
    });

    // –û—Ç—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç —Å—Ç–µ–Ω
    if(ball.x < 15 || ball.x > canvas.width - 15) ball.vx *= -0.8;

    // –î–æ—Å—Ç–∏–≥ –¥–Ω–∞
    if(ball.y > 480){
      let slots = [8, 4, 2, 1, 0.5, 1, 2, 4, 8];
      let slotIndex = Math.floor(ball.x / (canvas.width / slots.length));
      slotIndex = Math.max(0, Math.min(slots.length - 1, slotIndex));
      let mult = slots[slotIndex];
      let points = Math.round(mult * 2);
      score += points;
      document.getElementById("score").textContent = score;
      alert(`üéä Landed on ${mult}x!\n+${points} points!`);
      return;
    }

    requestAnimationFrame(animate);
  }
  animate();
}

/**********************
   BALL ESCAPE GAME
**********************/
function startEscape(){
  let canvas = document.getElementById("escapeCanvas");
  let ctx = canvas.getContext("2d");
  let ball = {x: 160, y: 220, vx: 3, vy: -4};
  let rotation = 0;
  let holeStart = Math.random() * Math.PI * 2;
  let holeSize = 0.8;

  function animate(){
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // –ö—Ä—É–≥–ª–∞—è –∞—Ä–µ–Ω–∞
    ctx.strokeStyle = "#ccc";
    ctx.lineWidth = 20;
    ctx.beginPath();
    ctx.arc(160, 220, 130, 0, Math.PI*2);
    ctx.stroke();

    // –ó–µ–ª—ë–Ω–∞—è –¥—ã—Ä–∞ (–≤—Ä–∞—â–∞–µ—Ç—Å—è)
    ctx.strokeStyle = "#4caf50";
    ctx.lineWidth = 25;
    ctx.beginPath();
    ctx.arc(160, 220, 130, holeStart + rotation, holeStart + rotation + holeSize);
    ctx.stroke();

    // –®–∞—Ä–∏–∫
    ctx.fillStyle = "#ff6bb5";
    ctx.beginPath();
    ctx.arc(ball.x, ball.y, 15, 0, Math.PI*2);
    ctx.fill();

    // –î–≤–∏–∂–µ–Ω–∏–µ —à–∞—Ä–∏–∫–∞
    ball.x += ball.vx;
    ball.y += ball.vy;

    // –û—Ç—Å–∫–æ–∫ –æ—Ç —Å—Ç–µ–Ω
    let dx = ball.x - 160;
    let dy = ball.y - 220;
    let dist = Math.sqrt(dx*dx + dy*dy);
    if(dist > 115){
      let angle = Math.atan2(dy, dx);
      ball.vx = -Math.cos(angle) * 6;
      ball.vy = -Math.sin(angle) * 6;
    }

    // –ü–æ–±–µ–≥ —á–µ—Ä–µ–∑ –¥—ã—Ä—É
    let ballAngle = Math.atan2(dy, dx);
    let normalizedBall = (ballAngle - holeStart - rotation + Math.PI*4) % (Math.PI*2);
    if(dist > 125 && normalizedBall < holeSize){
      score += 15;
      document.getElementById("score").textContent = score;
      alert("‚ö° BALL ESCAPED! +15 points! üèÜ");
      return;
    }

    rotation += 0.02;
    requestAnimationFrame(animate);
  }
  animate();
}
</script>
</body>
</html>
