<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Johan Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{
  --pink: #ff9ccd;
  --pink-dark: #ff6bb5;
  --pink-bg: #ffe6f3;
  --green-win: #afffa6;
  --red-lose: #ff6b6b;
}
body{
  margin:0;
  background:var(--pink-bg) url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJncmlkIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiPjxwYXRoIGQ9Ik0gNDAgMCAwIDAgMCA0MCIgc3Ryb2tlPSIjZmY4N2QwIiBzdHJva2Utd2lkdGg9IjAuNSIgZmlsbD0ibm9uZSIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNncmlkKSIvPjwvc3ZnPg=='); /* –ö—Ä–∞—Å–∏–≤—ã–π —Ä–æ–∑–æ–≤—ã–π —Ñ–æ–Ω —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º */
  font-family: 'Arial Rounded MT Bold', Arial, sans-serif;
  text-align:center;
  color:#333;
}
h1{
  font-size: 48px;
  color: var(--pink-dark);
  text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
  margin: 20px 0;
  animation: glow 2s infinite alternate;
}
@keyframes glow {
  from { text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }
  to { text-shadow: 0 0 10px var(--pink), 0 0 20px var(--pink-dark); }
}
h2{
  font-size: 32px;
  color: var(--pink-dark);
}
h3{
  font-size: 24px;
  margin: 10px;
}
button{
  padding: 14px 28px;
  border-radius: 15px;
  border: none;
  background: var(--pink);
  color: #000;
  margin: 10px;
  cursor: pointer;
  font-size: 20px;
  font-weight: bold;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  transition: all 0.2s;
}
button:hover{
  background: var(--pink-dark);
  transform: translateY(-2px) scale(1.05);
}
button:active{
  transform: translateY(1px);
}
button:disabled{
  background: #ccc;
  cursor: not-allowed;
  transform: none;
}
input[type="number"]{
  padding: 10px;
  border-radius: 10px;
  background: #fff;
  border: 1px solid var(--pink);
  font-size: 18px;
  margin: 10px;
  width: 100px;
}
select{
  padding: 10px;
  border-radius: 10px;
  background: #fff;
  border: 1px solid var(--pink);
  font-size: 18px;
  margin: 10px;
}
.screen{display:none;}
.active{display:block;}
.minecell{
  width: 60px;
  height: 60px;
  background: white;
  border-radius: 12px;
  font-size: 28px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  box-shadow: 0 3px 6px rgba(0,0,0,0.15);
  transition: all 0.2s;
}
.minecell:hover{
  transform: scale(1.05);
}
#minesGrid{
  display: grid;
  grid-template-columns: repeat(5, 60px);
  gap: 8px;
  justify-content: center;
  margin: 20px auto;
}
canvas{
  background: #fff;
  border-radius: 15px;
  box-shadow: 0 6px 12px rgba(0,0,0,0.2);
  margin: 15px auto;
  display: block;
}
#ton{
  font-size: 28px;
  font-weight: bold;
  color: var(--pink-dark);
}
.message{
  font-size: 20px;
  margin: 10px;
  padding: 10px;
  border-radius: 10px;
  color: #fff;
}
.message-win{
  background: var(--green-win);
  color: #000;
}
.message-lose{
  background: var(--red-lose);
}
#lobby {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
  background: rgba(255,255,255,0.8);
  border-radius: 20px;
  box-shadow: 0 10px 20px rgba(0,0,0,0.1);
}
#lobby button {
  display: block;
  width: 80%;
  margin: 20px auto;
  font-size: 24px;
}
#crashCanvas {
  width: 300px;
  height: 400px;
  border: 2px solid var(--pink-dark);
}
</style>
</head>
<body>
<h1>Johan Game</h1>
<h3>TON: <span id="ton">100</span></h3>

<!-- LOBBY -->
<div id="lobby" class="active">
  <h2>Welcome to Johan Game!</h2>
  <p>Choose your game mode:</p>
  <button onclick="openLobby('mines')">Mines Mode</button>
  <button onclick="openLobby('crash')">Crash Mode</button>
</div>

<!-- MINES LOBBY -->
<div id="mines-lobby" class="screen">
  <h2>Mines Mode</h2>
  <label>Bet (0.1-10 TON):</label>
  <input type="number" id="mines-bet" min="0.1" max="10" step="0.1" value="1"><br>
  <label>Number of Mines (5-10):</label>
  <select id="mines-count">
    <option value="5">5 Mines</option>
    <option value="6">6 Mines</option>
    <option value="7">7 Mines</option>
    <option value="8">8 Mines</option>
    <option value="9">9 Mines</option>
    <option value="10">10 Mines</option>
  </select><br>
  <button onclick="startMines()">Start Mines</button>
  <button onclick="backToLobby()">‚Üê Back to Lobby</button>
</div>

<!-- MINES GAME -->
<div id="mines-game" class="screen">
  <h2>Mines</h2>
  <p>Tiles opened: <span id="opened">0</span></p>
  <p>Multiplier: <span id="multi">1.00x</span></p>
  <div id="mines-message" class="message"></div>
  <button id="mines-cashout" onclick="cashout()" style="background:#ff6bb5;">Cash Out üí∞</button>
  <div id="minesGrid"></div>
  <button onclick="backToLobbyMain('mines')">‚Üê Back to Lobby</button>
</div>

<!-- CRASH LOBBY -->
<div id="crash-lobby" class="screen">
  <h2>Crash Mode</h2>
  <label>Bet (0.1-10 TON):</label>
  <input type="number" id="crash-bet" min="0.1" max="10" step="0.1" value="1"><br>
  <button onclick="startCrash()">Start Crash</button>
  <button onclick="backToLobby()">‚Üê Back to Lobby</button>
</div>

<!-- CRASH GAME -->
<div id="crash-game" class="screen">
  <h2>Crash</h2>
  <p>Current Multiplier: <span id="crash-multi">1.00x</span></p>
  <div id="crash-message" class="message"></div>
  <canvas id="crashCanvas" width="300" height="400"></canvas>
  <button id="crash-cashout" onclick="crashCashout()" style="background:#ff6bb5;">Cash Out üí∞</button>
  <button onclick="backToLobbyMain('crash')">‚Üê Back to Lobby</button>
</div>

<script>
let ton = 100;
document.getElementById("ton").textContent = ton.toFixed(1);

function openLobby(id){
  hideAll();
  document.getElementById(id + "-lobby").classList.add("active");
}

function backToLobby(){
  hideAll();
  document.getElementById("lobby").classList.add("active");
}

function backToLobbyMain(id){
  hideAll();
  document.getElementById("lobby").classList.add("active");
}

function hideAll(){
  document.querySelectorAll(".screen, #lobby").forEach(x => x.classList.remove("active"));
}

function showMessage(id, text, type){
  let msg = document.getElementById(id + "-message");
  msg.innerHTML = text;
  msg.className = "message " + (type === "win" ? "message-win" : "message-lose");
  setTimeout(() => { msg.innerHTML = ""; }, 5000);
}

/**********************
   MINES GAME
**********************/
let mines = [];
let revealed = 0;
let multiplier = 1;
let currentBet = 1;
let mineCount = 5;
let gameOver = false;

function startMines(){
  currentBet = parseFloat(document.getElementById("mines-bet").value);
  if(currentBet < 0.1 || currentBet > 10 || isNaN(currentBet)) return showMessage("mines", "Invalid bet! 0.1-10 TON.", "lose");
  mineCount = parseInt(document.getElementById("mines-count").value);
  if(ton < currentBet) return showMessage("mines", "Not enough TON!", "lose");
  ton -= currentBet;
  document.getElementById("ton").textContent = ton.toFixed(1);

  mines = [];
  revealed = 0;
  multiplier = 1;
  gameOver = false;
  document.getElementById("opened").textContent = 0;
  document.getElementById("multi").textContent = "1.00x";
  document.getElementById("mines-cashout").disabled = false;

  while(mines.length < mineCount){
    let r = Math.floor(Math.random() * 25);
    if(!mines.includes(r)) mines.push(r);
  }

  let grid = document.getElementById("minesGrid");
  grid.innerHTML = "";
  for(let i = 0; i < 25; i++){
    let cell = document.createElement("div");
    cell.className = "minecell";
    cell.textContent = "?";
    cell.onclick = () => reveal(i, cell);
    grid.appendChild(cell);
  }

  hideAll();
  document.getElementById("mines-game").classList.add("active");
}

function reveal(i, cell){
  if(cell.dataset.open || gameOver) return;

  if(mines.includes(i)){
    cell.style.background = "var(--red-lose)";
    cell.textContent = "üí£";
    gameOver = true;
    document.getElementById("mines-cashout").disabled = true;
    showMessage("mines", `üí• BOOM! Lost ${currentBet.toFixed(1)} TON üòø`, "lose");
    setTimeout(() => backToLobbyMain('mines'), 3000);
    return;
  }

  revealed++;
  multiplier *= 1.02;
  cell.dataset.open = 1;
  cell.style.background = "var(--green-win)";
  cell.textContent = "üíé";
  cell.style.transform = "scale(1.1)";

  document.getElementById("opened").textContent = revealed;
  document.getElementById("multi").textContent = multiplier.toFixed(2) + "x";
}

function cashout(){
  if(revealed === 0 || gameOver) {
    showMessage("mines", "Cannot cash out now!", "lose");
    return;
  }

  let win = (currentBet * multiplier).toFixed(1);
  ton += parseFloat(win);
  document.getElementById("ton").textContent = ton.toFixed(1);
  showMessage("mines", `üéâ Cashed out at ${multiplier.toFixed(2)}x! Won ${win} TON! üèÜ`, "win");
  document.getElementById("mines-cashout").disabled = true;
  setTimeout(() => backToLobbyMain('mines'), 3000);
}

/**********************
   CRASH GAME
**********************/
let crashBet = 1;
let crashMultiplier = 1;
let crashGameOver = false;
let crashInterval;
let crashPoint;

function startCrash(){
  crashBet = parseFloat(document.getElementById("crash-bet").value);
  if(crashBet < 0.1 || crashBet > 10 || isNaN(crashBet)) return showMessage("crash", "Invalid bet! 0.1-10 TON.", "lose");
  if(ton < crashBet) return showMessage("crash", "Not enough TON!", "lose");
  ton -= crashBet;
  document.getElementById("ton").textContent = ton.toFixed(1);

  crashMultiplier = 1;
  crashGameOver = false;
  document.getElementById("crash-multi").textContent = "1.00x";
  document.getElementById("crash-cashout").disabled = false;

  // Random crash point between 1.01 and 50x
  crashPoint = 1 + Math.random() * 49;

  let canvas = document.getElementById("crashCanvas");
  let ctx = canvas.getContext("2d");
  let rocketY = canvas.height - 50;
  let speed = 2;

  crashInterval = setInterval(() => {
    if (crashGameOver) return;

    crashMultiplier *= 1.02; // Increase multiplier
    document.getElementById("crash-multi").textContent = crashMultiplier.toFixed(2) + "x";

    if (crashMultiplier >= crashPoint) {
      crashGameOver = true;
      document.getElementById("crash-cashout").disabled = true;
      showMessage("crash", `üí• CRASH at ${crashMultiplier.toFixed(2)}x! Lost ${crashBet.toFixed(1)} TON üòø`, "lose");
      clearInterval(crashInterval);
      setTimeout(() => backToLobbyMain('crash'), 3000);
      return;
    }

    // Animate rocket
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "#ff6bb5";
    ctx.beginPath();
    ctx.moveTo(150, rocketY);
    ctx.lineTo(140, rocketY + 20);
    ctx.lineTo(160, rocketY + 20);
    ctx.closePath();
    ctx.fill(); // Simple rocket triangle
    rocketY -= speed;
    if (rocketY < 0) rocketY = canvas.height - 50; // Loop if needed, but crash will stop
  }, 200); // Update every 200ms

  hideAll();
  document.getElementById("crash-game").classList.add("active");
}

function crashCashout(){
  if (crashGameOver) return;

  let win = (crashBet * crashMultiplier).toFixed(1);
  ton += parseFloat(win);
  document.getElementById("ton").textContent = ton.toFixed(1);
  showMessage("crash", `üéâ Cashed out at ${crashMultiplier.toFixed(2)}x! Won ${win} TON! üèÜ`, "win");
  crashGameOver = true;
  document.getElementById("crash-cashout").disabled = true;
  clearInterval(crashInterval);
  setTimeout(() => backToLobbyMain('crash'), 3000);
}
</script>
</body>
</html>
