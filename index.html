<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Johan Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
 --pink:#ff9ccd;
 --pink-bg:#ffe6f3;
}

body{
 margin:0;
 background:var(--pink-bg);
 font-family:Arial, sans-serif;
 text-align:center;
 user-select:none;
}

h1,h2{margin:12px 0;}

button{
 padding:12px 20px;
 border-radius:10px;
 border:0;
 background:var(--pink);
 color:#000;
 margin:10px;
 cursor:pointer;
 font-size:18px;
}

.screen{display:none;}
.active{display:block;}

.minecell{
 width:55px;height:55px;
 background:white;border-radius:8px;
 font-size:22px;
 display:flex;justify-content:center;align-items:center;
 cursor:pointer;
}

#minesGrid{
 display:grid;
 grid-template-columns:repeat(5,55px);
 gap:5px;
 justify-content:center;
 margin-top:15px;
}

#plinkoCanvas,#escapeCanvas{
 background:#fff;
 display:block;
 margin:10px auto;
 border-radius:10px;
}
</style>
</head>
<body>

<h1>Johan Game</h1>

<h3>Score: <span id="score">100</span></h3>

<!-- MENU -->
<div id="menu" class="active">
 <button onclick="openScreen('mines')">Mines</button>
 <button onclick="openScreen('plinko')">Plinko</button>
 <button onclick="openScreen('escape')">Ball Escape</button>
</div>

<!-- MINES -->
<div id="mines" class="screen">
 <h2>Mines</h2>

Tiles opened: <span id="opened">0</span><br>
Multiplier: <span id="multi">1.00x</span><br><br>

<button onclick="startMines()">New Game</button>
<button onclick="cashout()">Cash Out</button>

<div id="minesGrid"></div>

<button onclick="back()">Back</button>
</div>

<!-- PLINKO -->
<div id="plinko" class="screen">
 <h2>Plinko</h2>

<button onclick="startPlinko()">Drop Ball</button>

<canvas id="plinkoCanvas" width="300" height="500"></canvas>

<button onclick="back()">Back</button>
</div>

<!-- BALL ESCAPE -->
<div id="escape" class="screen">
 <h2>Ball Escape</h2>

<button onclick="startEscape()">Play</button>

<canvas id="escapeCanvas" width="300" height="420"></canvas>

<button onclick="back()">Back</button>
</div>


<script>
function openScreen(id){
 document.getElementById("menu").classList.remove("active");
 document.getElementById(id).classList.add("active");
}

function back(){
 document.querySelectorAll(".screen").forEach(x=>x.classList.remove("active"));
 document.getElementById("menu").classList.add("active");
}

let score = 100;
document.getElementById("score").textContent = score;

/**********************
   MINES GAME
**********************/
let mines=[];
let revealed=0;
let multiplier=1;

function startMines(){
 mines=[];
 revealed=0;
 multiplier=1;
 document.getElementById("opened").textContent=0;
 document.getElementById("multi").textContent="1.00x";

 while(mines.length<8){
  let r=Math.floor(Math.random()*25);
  if(!mines.includes(r))mines.push(r);
 }

 let g=document.getElementById("minesGrid");
 g.innerHTML="";

 for(let i=0;i<25;i++){
  let d=document.createElement("div");
  d.className="minecell";
  d.textContent="?";
  d.onclick=()=>reveal(i,d);
  g.append(d);
 }
}

function reveal(i,cell){
 if(cell.dataset.open)return;

 if(mines.includes(i)){
  cell.style.background="red";
  cell.textContent="ðŸ’£";
  alert("Boom! Lost 5 points!");
  score-=5;
  document.getElementById("score").textContent=score;
  startMines();
  return;
 }

 revealed++;
 multiplier+=0.15;
 cell.dataset.open=1;
 cell.style.background="#afffa6";
 cell.textContent="â˜…";

 document.getElementById("opened").textContent=revealed;
 document.getElementById("multi").textContent=multiplier.toFixed(2)+"x";
}

function cashout(){
 if(revealed===0)return;

 let win = Math.round(5*multiplier);
 alert("You won "+win+" points!");

 score+=win;
 document.getElementById("score").textContent=score;

 startMines();
}

/**********************
   PLINKO GAME
**********************/
function startPlinko(){
 let c=document.getElementById("plinkoCanvas");
 let ctx=c.getContext("2d");

 let pegs=[];
 for(let r=0;r<8;r++){
  for(let p=0;p<r+3;p++){
   pegs.push({
     x:150 - (r*15) + p*30,
     y:80+r*45
   });
  }
 }

 let ball={x:150,y:20,vx:0,vy:2};

 function loop(){
  ctx.clearRect(0,0,300,500);

  ctx.fillStyle="black";
  pegs.forEach(p=>{
    ctx.beginPath();
    ctx.arc(p.x,p.y,5,0,6.28);
    ctx.fill();
  });

  ctx.beginPath();
  ctx.arc(ball.x,ball.y,8,0,6.28);
  ctx.fill();

  ball.y+=ball.vy;

  pegs.forEach(p=>{
    let dx=ball.x-p.x;
    let dy=ball.y-p.y;
    let d=Math.sqrt(dx*dx+dy*dy);
    if(d<13){
     ball.vx=(Math.random()-0.5)*4;
    }
  });

  ball.x+=ball.vx;

  if(ball.y>470){
   let slot=Math.floor(ball.x/50);
   let mult=[5,2,1,0,1,2,5][slot]||0;
   score+=mult;
   document.getElementById("score").textContent=score;
   alert("+"+mult+" points!");
   return;
  }

  requestAnimationFrame(loop);
 }
 loop();
}

/**********************
 BALL ESCAPE GAME
**********************/
function startEscape(){
 let c=document.getElementById("escapeCanvas");
 let ctx=c.getContext("2d");

 let angle=0;
 let speed=0.03;
 let ball={x:150,y:150,vx:2,vy:3};

 let holeStart=Math.random()*3.14;
 let holeEnd=holeStart+0.7;

 function loop(){
  ctx.clearRect(0,0,300,420);

  ctx.beginPath();
  ctx.arc(150,160,120,0,6.28);
  ctx.stroke();

  ctx.beginPath();
  ctx.arc(150,160,120,holeStart,holeEnd);
  ctx.strokeStyle="green";
  ctx.lineWidth=10;
  ctx.stroke();

  ctx.lineWidth=1;
  ctx.strokeStyle="black";

  ctx.beginPath();
  ctx.arc(ball.x,ball.y,10,0,6.28);
  ctx.fill();

  ball.x+=ball.vx;
  ball.y+=ball.vy;

  let dx=ball.x-150;
  let dy=ball.y-160;
  let dist=Math.sqrt(dx*dx+dy*dy);

  if(dist>110){
   ball.vx*=-1;
   ball.vy*=-1;
  }

  if(dist>115 && angle>holeStart && angle<holeEnd){
    score+=10;
    document.getElementById("score").textContent=score;
    alert("Ball escaped! +10 points!");
    return;
  }

  angle+=speed;

  requestAnimationFrame(loop);
 }
 loop();
}
</script>

</body>
</html>
