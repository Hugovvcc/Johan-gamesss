<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Johan Game</title>

<style>
body{
  background: linear-gradient(180deg, #ffc7e8, #ffecfb);
  margin:0;
  font-family:Arial;
  color:#333;
  overflow:hidden;
  text-align:center;
}

.gameSwitcher{
  display:flex;
  justify-content:center;
  gap:15px;
  margin-top:20px;
}

.gameSwitcher button{
  padding:12px 18px;
  background:white;
  border-radius:12px;
  border:none;
  font-weight:bold;
  cursor:pointer;
  box-shadow:0 0 8px rgba(0,0,0,0.1);
}

.hidden{
 display:none;
}

/* MINES AREA */

#minesArea{
 margin-top:25px;
}

#mineGrid{
  display:grid;
  width:340px;
  height:340px;
  margin:15px auto;
  grid-template-columns:repeat(5,1fr);
  gap:4px;
}

.mineTile{
  background:white;
  border-radius:8px;
  cursor:pointer;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:25px;
  font-weight:bold;
  box-shadow:0 0 6px rgba(0,0,0,0.2);
}

.mineTile.open{
  background:#ffe2f3;
}

.mineTile.boom{
  background:red;
}

/* BLINKO */

#blinkoArea{
 margin-top:10px;
}

#blinkoCanvas{
 background:white;
 border-radius:15px;
 margin:auto;
 display:block;
 box-shadow:0 0 6px rgba(0,0,0,0.15);
}

/* UI components */

.ton{
font-size:25px;
font-weight:bold;
margin-top:5px;
}

</style>

</head>

<body>

<h1>JOHAN GAME</h1>

<div class="ton">
Balance: <span id="balance">5.00</span> TON
</div>

<div class="gameSwitcher">
<button onclick="openMines()">MINES</button>
<button onclick="openBlinko()">BLINKO</button>
</div>

<!-- ███ MINES GAME ███ -->

<div id="minesArea">

<h2>Mines</h2>

<label>Bet TON:</label>
<input id="mineBet" type="number" value="0.1" step="0.1">

<br>

<label>Mines Count:</label>
<input id="mineCount" type="number" value="3" min="1" max="10">

<br><br>

<button onclick="startMines()">START</button>
<button onclick="cashoutMines()">CASHOUT</button>

<div id="mineGrid"></div>

<h3 id="mineStatus"></h3>
</div>

<!-- ███ BLINKO GAME ███ -->

<div id="blinkoArea" class="hidden">

<h2>Blinko</h2>

<label>Bet TON:</label>
<input id="blinkoBet" type="number" value="0.1" step="0.1">

<br><br>

<canvas id="blinkoCanvas" width="300" height="460"></canvas>

<button onclick="dropBall()">PLAY</button>

<h3 id="blinkoResult"></h3>

</div>




<script>
/*********** GLOBAL ***********/
let balance = 5.00;

/*********** SCREEN SWITCH ***********/
function openMines(){
 document.getElementById("minesArea").classList.remove("hidden");
 document.getElementById("blinkoArea").classList.add("hidden");
}

function openBlinko(){
 document.getElementById("minesArea").classList.add("hidden");
 document.getElementById("blinkoArea").classList.remove("hidden");
}

function updateBalance(){
 document.getElementById("balance").innerText = balance.toFixed(2);
}

updateBalance();

/************* MINES GAME ****************/

let mineBombs = [];
let openedTiles = 0;
let mineRunning = false;

function startMines(){

 let bet = Number(document.getElementById("mineBet").value);
 let amount = Number(document.getElementById("mineCount").value);

 if(bet < 0.1){
   alert("min bet 0.1 TON");
   return;
 }

 if(balance < bet){
  alert("Not enough TON");
  return;
 }

 mineRunning=true;
 openedTiles=0;
 balance -= bet;
 updateBalance();

 document.getElementById("mineStatus").innerText = "Pick tiles!";

 let grid = document.getElementById("mineGrid");
 grid.innerHTML="";

 mineBombs=[];

 while(mineBombs.length < amount){
   let r = Math.floor(Math.random()*25);
   if(!mineBombs.includes(r)) mineBombs.push(r);
 }

 for(let i=0;i<25;i++){
   let tile = document.createElement("div");
   tile.className="mineTile";
   tile.dataset.id=i;
   tile.onclick=openTile;
   grid.appendChild(tile);
 }

}

function openTile(){
 if(!mineRunning) return;

 let id = Number(this.dataset.id);

 if(mineBombs.includes(id)){
   this.classList.add("boom");
   document.getElementById("mineStatus").innerText = "LOST!";
   mineRunning=false;
   return;
 }

 this.classList.add("open");
 this.innerHTML="⭐";
 openedTiles++;

 let win = (openedTiles * 0.125);

 document.getElementById("mineStatus").innerText = "safe! +" + win.toFixed(2);

}

function cashoutMines(){

 if(openedTiles == 0){ alert("Open tiles first!"); return; }

 let bet = Number(document.getElementById("mineBet").value);

 let profit = bet * (1 + openedTiles*0.125);

 balance += profit;
 updateBalance();

 document.getElementById("mineStatus").innerText = "CASHOUT " + profit.toFixed(2);
 mineRunning=false;
}

/************* BLINKO ****************/

const canvas = document.getElementById("blinkoCanvas");
const ctx = canvas.getContext("2d");

let pins = [];
let balls = [];

createPins();

// ---- create 8 rows ---- 

function createPins(){

 let rows = 8;
 let spacingX = 30;
 let spacingY = 45;

 for(let r=0;r<rows;r++){
   for(let c=0;c<=r;c++){

     let x = 150 - (r*spacingX/2) + c*spacingX;
     let y = 60 + r*spacingY;

     pins.push({x,y});
   }
 }
}

function dropBall(){

 let bet = Number(document.getElementById("blinkoBet").value);

 if(bet < 0.1){
  alert("min bet 0.1 TON");
  return;
 }

 if(balance < bet){
  alert("Not enough TON");
  return;
 }

 balance -= bet;
 updateBalance();

 balls.push({
  x:150,
  y:20,
  vy:0,
  path:[]
 });

 document.getElementById("blinkoResult").innerText="";
}

function loop(){

 ctx.clearRect(0,0,300,460);

 for(let p of pins){
   ctx.beginPath();
   ctx.arc(p.x,p.y,5,0,7);
   ctx.fillStyle="#c079ff";
   ctx.fill();
 }

 for(let b of balls){

   b.vy += 0.25;
   b.y += b.vy;

   for(let p of pins){

     let dx = b.x-p.x;
     let dy = b.y-p.y;
     let dist = Math.sqrt(dx*dx + dy*dy);

     if(dist < 10){

      if(Math.random()>0.5) b.x += 4;
      else b.x -= 4;

      b.vy *= 0.6;
     }
   }

   ctx.beginPath();
   ctx.arc(b.x,b.y,8,0,7);
   ctx.fillStyle="#ff45bf";
   ctx.fill();

   if(b.y > 430){

    finishBlinko(b);
    balls.splice(balls.indexOf(b),1);
   }

 }

 requestAnimationFrame(loop);

}

loop();

function finishBlinko(b){

 let zone = Math.floor(b.x / (300/7));

 let mult = [0,0.8,1.5,2.5,1.5,0.8,0][zone];

 let bet = Number(document.getElementById("blinkoBet").value);

 let win = bet * mult;

 balance += win;
 updateBalance();

 document.getElementById("blinkoResult").innerText =
"Ball result: x"+mult.toFixed(1)+" → +"+win.toFixed(2)+"TON";
}

</script>

</body>
</html>
