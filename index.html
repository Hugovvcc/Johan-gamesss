<!DOCTYPE html>
<html>
<head>
<title>Johan Game</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>

body {
    background: linear-gradient(135deg,#ff9ee2,#ffc6ef,#ffe9f8);
    font-family: Arial, sans-serif;
    text-align:center;
    margin:0;
    padding:0;
    color:#ff008c;
}

/* navigation tabs */

#nav {
    display:flex;
    justify-content:center;
    gap:20px;
    margin-top:15px;
}

.navbtn{
    padding:10px 20px;
    background:#ff34c3;
    border:none;
    border-radius:8px;
    color:white;
    cursor:pointer;
    font-size:17px;
}

#balanceBox {
    margin-top:10px;
    font-size:22px;
    color:#a30061;
}

/* game containers */
.gamePage{
    display:none;
    margin-top:20px;
}

/* ----- MINES ----- */

#minesBoard{
    width:290px;
    height:290px;
    margin:auto;
    display:grid;
    grid-template-columns: repeat(5,1fr);
    gap:5px;
}

.mineCell{
    background:#ff79d1;
    border-radius:6px;
    cursor:pointer;
}

.mineRevealed {
    background:white !important;
    color:black;
}

/* ----- PLINKO ----- */

#plinkoCanvas{
    background:#ffeafc;
    border-radius:15px;
}

#plinkoStartBtn{
    padding:12px 25px;
    border:none;
    background:#ff34c3;
    color:white;
    font-size:18px;
    border-radius:10px;
    cursor:pointer;
    margin-top:10px;
}

</style>
</head>

<body>

<h1 style="margin-top:20px;">Johan Game</h1>

<div id="balanceBox">Points: 100</div>

<div id="nav">
<button class="navbtn" onclick="showMines()">Mines</button>
<button class="navbtn" onclick="showPlinko()">Plinko</button>
</div>

<!-- MINES GAME -->
<div id="minesPage" class="gamePage">

<h2>Mines</h2>

<p>Find safe tiles and earn points</p>

<div id="minesBoard"></div>

<button class="navbtn" onclick="restartMines()">Restart Mines</button>

</div>

<!-- PLINKO GAME -->
<div id="plinkoPage" class="gamePage">

<h2>Plinko</h2>

<canvas id="plinkoCanvas" width="360" height="450"></canvas>

<button id="plinkoStartBtn">DROP</button>

</div>

<script>

let balance = 100;

// ----------- Page switching ----------

document.getElementById("minesPage").style.display="block";

function showMines(){
    document.getElementById("minesPage").style.display="block";
    document.getElementById("plinkoPage").style.display="none";
}

function showPlinko(){
    document.getElementById("plinkoPage").style.display="block";
    document.getElementById("minesPage").style.display="none";
}

// ========== MINES GAME =============

let minesCount = 6;
let minePositions = [];
let minesBoard = document.getElementById("minesBoard");

function restartMines(){
    minesBoard.innerHTML = "";
    minePositions = [];

    while(minePositions.length < minesCount){
        let r = Math.floor(Math.random()*25);
        if(!minePositions.includes(r)) minePositions.push(r);
    }

    for(let i=0;i<25;i++){
        let cell = document.createElement("div");
        cell.className="mineCell";
        cell.dataset.id=i;
        cell.onclick = revealMine;
        minesBoard.appendChild(cell);
    }
}

function revealMine(){
    let id = Number(this.dataset.id);

    this.classList.add("mineRevealed");

    if(minePositions.includes(id)){
        this.style.background="red";
        balance -= 5;
        updateBalance();
        setTimeout(()=>restartMines(),500);
    } 
    else {
        this.innerHTML="â˜…";
        balance += 5;
        updateBalance();
    }
}

restartMines();

// ========== PLINKO GAME =============

let pCanvas = document.getElementById("plinkoCanvas");
let pCtx = pCanvas.getContext("2d");

let pBall = null;
let pPegs = [];
let pSlots = [];
let pRows = 8;
let pSpacing = 38;

for(let r=0;r<pRows;r++){
    for(let c=0;c<r+4;c++){
        pPegs.push({
            x: 70 + c*pSpacing - r*18,
            y: 60 + r*pSpacing
        });
    }
}

let slotCount = 6;
let slotWidth = pCanvas.width / slotCount;
let slotMulti = [-2,-1,1,1,-1,-2];

for(let i=0;i<slotCount;i++){
    pSlots.push({
        x:i*slotWidth,
        result:slotMulti[i]
    });
}

function pDraw(){
    pCtx.clearRect(0,0,360,450);

    pCtx.fillStyle="#ff00c3";
    pPegs.forEach(p=>{
        pCtx.beginPath();
        pCtx.arc(p.x,p.y,5,0,Math.PI*2);
        pCtx.fill();
    });

    pSlots.forEach((s,i)=>{
        pCtx.fillStyle = s.result < 0 ? "#ff88c4" : "#8dffc0";
        pCtx.fillRect(s.x,420,slotWidth,30);
    });

    if(pBall){
        pCtx.beginPath();
        pCtx.fillStyle="black";
        pCtx.arc(pBall.x,pBall.y,7,0,Math.PI*2);
        pCtx.fill();

        pBall.y += 1.4;

        pPegs.forEach(p=>{
            let dx = pBall.x - p.x;
            let dy = pBall.y - p.y;
            let d = Math.sqrt(dx*dx+dy*dy);

            if(d<9){
                pBall.vx = (Math.random()-0.5)*3;
                pBall.y += 3;
            }
        });

        pBall.x += pBall.vx;

        if(pBall.y > 420){
            let id = Math.floor(pBall.x / slotWidth);
            balance += pSlots[id].result * 10;
            updateBalance();
            pBall = null;
        }
    }
}

setInterval(pDraw,12);

document.getElementById("plinkoStartBtn").onclick = ()=>{
    if(pBall!=null)return;

    balance -=5;
    updateBalance();

    pBall = {
        x: pCanvas.width/2,
        y: 10,
        vx: 0
    };
};

// balance update
function updateBalance(){
    document.getElementById("balanceBox").innerHTML ="Points: " + balance;
}

</script>

</body>
</html>
