<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Johan Game Plinko</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{
 --pink:#f8b6d2;
 --pink-soft:#fde7f1;
 --pink-dark:#f29bc1;
 --green:#7dd3a7;
 --red:#ff6b6b;
}

*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto}

body{
 margin:0;
 background:linear-gradient(180deg,#fde7f1,#f8b6d2);
 display:flex;
 justify-content:center;
}

.app{width:100%;max-width:420px;padding:16px}
h1{text-align:center}

.balance{
 background:rgba(255,255,255,.7);
 border-radius:16px;
 padding:12px;
 text-align:center;
 font-weight:600;
 margin-bottom:12px;
}

.tabs{
 display:flex;
 gap:8px;
 margin-bottom:12px;
}

.tab{
 flex:1;
 padding:10px;
 border-radius:14px;
 background:rgba(255,255,255,.6);
 text-align:center;
 cursor:pointer;
 font-weight:600;
}

.tab.active{background:var(--pink-dark);color:white}

.section{display:none}
.section.active{display:block}

.controls{
 background:rgba(255,255,255,.6);
 border-radius:16px;
 padding:12px;
}

.control-row{
 display:flex;
 justify-content:space-between;
 margin-bottom:8px;
}

input,select{
 border:none;
 border-radius:12px;
 padding:6px 10px;
}

button{
 width:100%;
 border:none;
 border-radius:16px;
 padding:12px;
 font-weight:600;
 background:var(--pink-dark);
 color:white;
 cursor:pointer;
 margin-top:8px;
}

button:disabled{opacity:.5}

canvas{
 width:100%;
 background:rgba(255,255,255,.8);
 border-radius:16px;
 margin-top:12px;
}
</style>
</head>

<body>
<div class="app">
<h1>üéÆ Johan Game</h1>
<div class="balance">Balance: <span id="balance">10.00</span> TON</div>

<div class="tabs">
 <div class="tab active" onclick="show('blinko')">Blinko</div>
</div>

<div id="blinko" class="section active">
<div class="controls">
 <div class="control-row">
  <label>Bet (min 0.1)</label>
  <input id="blinkoBet" type="number" min="0.1" step="0.1" value="0.1">
 </div>
 <button onclick="dropBall()">Drop Ball</button>
</div>

<canvas id="plinko" width="360" height="420"></canvas>
</div>
</div>

<script>
let balance = 10;
const balanceEl = document.getElementById("balance");
function updateBalance(){ balanceEl.textContent = balance.toFixed(2); }
updateBalance();

/* tabs */
function show(id){
 document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
 document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
 document.getElementById(id).classList.add("active");
 event.target.classList.add("active");
}

/* BLINKO */
const canvas = document.getElementById("plinko");
const ctx = canvas.getContext("2d");

// –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —à–∞—Ä–∏–∫–∞
const ballImg = new Image();
ballImg.src = '/mnt/data/a858e602-baa2-4b19-b130-c179c0ee704a.png';

const slotMultipliers = [0, 0.8, 1.5, 2.5, 1.5, 0.8, 0];
const pegRows = [];
const cols = 7;
const rows = 5;

// –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–µ–≥–æ–≤
for(let y=80; y<=260; y+=40){
 let row = [];
 for(let x=30; x<=330; x+=60){
   row.push({x:x, y:y});
 }
 pegRows.push(row);
}

function drawBoard(){
 ctx.clearRect(0,0,360,420);
 // —Ä–∏—Å—É–µ–º –ø–µ–≥–∏
 ctx.fillStyle = "#f29bc1";
 for(let row of pegRows){
   for(let peg of row){
     ctx.beginPath();
     ctx.arc(peg.x, peg.y, 6, 0, Math.PI*2);
     ctx.fill();
   }
 }
 // —Ä–∏—Å—É–µ–º —Å–ª–æ—Ç –ª–∏–Ω–∏–∏
 for(let i=0; i<=cols; i++){
   ctx.fillStyle = "#fde7f1";
   ctx.fillRect(i*360/cols-2, 380, 4, 40);
 }
}

function dropBall(){
 let bet = +document.getElementById("blinkoBet").value;
 if(bet<0.1 || bet>balance){ return alert("Invalid bet"); }
 balance -= bet;
 updateBalance();

 let x = 180, y = 20, vx = 0, vy = 4;
 let path = []; // –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ —Å–ª–æ—Ç—ã

 const interval = setInterval(()=>{
   drawBoard();
   // —Å–ª—É—á–∞–π–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
   if(Math.floor(y/40)<pegRows.length){
     let row = pegRows[Math.floor(y/40)];
     let closest = row.reduce((a,b)=>Math.abs(b.x-x)<Math.abs(a.x-x)?b:a);
     vx += (Math.random()-0.5)*2;
     if(Math.abs(x-closest.x)<5) vx = 0;
   }
   x += vx;
   y += vy;

   ctx.drawImage(ballImg, x-8, y-8, 16,16);

   if(y>=380){
     clearInterval(interval);
     let slot = Math.floor(x/(360/cols));
     if(slot<0) slot=0;
     if(slot>=cols) slot=cols-1;
     let win = bet * slotMultipliers[slot];
     balance += win;
     updateBalance();
     alert("You won " + win.toFixed(2) + " TON!");
   }
 },30);
}

drawBoard();
</script>
</body>
</html>
